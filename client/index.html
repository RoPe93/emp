<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="A Local Client to communicate with your local EMP Email node.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>EMPLocal | The Local EMP Client</title>

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="196x196" href="images/touch/chrome-touch-icon-196x196.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="EMPLocal">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#3372DF">

    <!-- build:css styles/components/main.min.css -->
    <link rel="stylesheet" href="styles/h5bp.css">
    <link rel="stylesheet" href="styles/components/components.css">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/app.css">
    <!-- endbuild -->

    <link rel="stylesheet" href="styles/colorbox.css">
    <script src="scripts/jquery.min.js"></script>
    <script src="scripts/jquery.colorbox.js"></script>
  </head>
  <body>
    <header class="app-bar promote-layer">
      <div class="app-bar-container">
        <button class="menu"><img src="images/hamburger.svg" alt="Menu"></button>
        <h1 class="logo">EMPLocal: The Local EMP Client</h1>
        <section class="app-bar-actions">
        <!-- Put App Bar Buttons Here -->
        </section>
      </div>
    </header>

    <nav class="navdrawer-container promote-layer">
      <h4>Navigation</h4>
      <ul>
        <li><a href="#inbox">Inbox</a></li>
        <li><a href="#outbox">Outbox</a></li>
        <li><a href="#sendbox">Sendbox</a></li>
        <li><a href="#address">Address Book</a></li>
      </ul>
    </nav>

    <main>
      <header class="container">
        <h3 class="xlarge" id="box">Loading...</h3>
        <div class="datarow">
        <a onclick="reloadPage()" class="button--primary" id="refresh">Refresh</a>
        <a onclick="newModal()" class="button--primary" id="new">New Message</a>
        </div>
      </header>
      <table id="main">
        <colgroup>
        </colgroup>
        <thead>
        </thead>
        <tbody>
        </tbody>
      </table>
    </main>

    <!-- Modals -->

    <div id="messageModal">
      <h4 class="medium">
        From: <span id="sender"></span> | 
        To: <span id="recipient"></span> | 
        Sent: <span id="sent"></span>
      </h4>
      <h3 class="large"><b id="subject"></b></h3>
      <p class="base" id="text"></p>
      <p class="small">MIME Type: <span id="mime"></span></p>
    </div>

    <div id="newModal">
      <h2 class="large">New Message</h2>
      <hr />
      <form onsubmit="sendMessage()">
        <p class="medium"> From:
          <select name="from" class="formSelect">
          </select>
        </p>
        <p class="medium"> To:
          <select name="from" class="formSelect">
          </select>
        </p>
        <p class="medium"> Subject:
          <input type="text" name="subject" class="formText"/>
        </p>
        <h4 class="medium"><b>Message:</b></h4>
        <textarea name="message" class="formText" ></textarea>
        <input type="submit" value="Send" />
      </form>
    </div>

    <div id="addrDetailModal">
      <h2 class="large">Address Detail</h2>
      <hr />
      <h3>Address: <span id="address"></span></h3>
      <form name="addrDetail" onsubmit="return addUpdateAddress('addrDetail')">
        <input type="hidden" id="addr" name="addr" />
      <p class="medium"> Public Key:<br />
        <input type="text" id="pubkey" name="pubkey" class="formText" />
      </p>
      <p class="medium"> Private Key:<br />
        <input type="text" id="privkey" name="privkey" class="formText" />
      </p>
      <p>
        <input type="submit" value="Update Address" />
      </p>
      </form>
    </div>

    <div id="addrModal">
      <h2 class="large">New Address</h2>
      <hr />
      <div class="datarow">
        <a onclick="createAddress()" class="button--primary">Generate New</a>
      </div>
      <h3>Import New:</h3>
      <form onsubmit="return addUpdateAddress('addrForm')" name="addrForm">
      <p class="medium"> Address:<br />
        <input type="text" name="addr" class="formText" />
      </p> 
      <p class="medium"> Public Key (optional):<br />
        <input type="text" name="pubkey" class="formText" />
      </p>
      <p class="medium"> Private Key (optional):<br />
        <input type="text" name="privkey" class="formText" />
      </p>
      <p>
        <input type="submit" value="Update Address" />
      </p>
      </form>
    </div>


    <!-- End Modals -->

    <!-- build:js scripts/main.min.js -->
    <script src="scripts/main.js"></script>
    <script src="scripts/app.js"></script>
    <!-- endbuild -->

    <script type="text/javascript">
    $(document).ready(function() {
      // Hide Modals
      $("#messageModal").hide();
      $("#newModal").hide();
      $("#addrDetailModal").hide();
      $("#addrModal").hide();

      window.emplogin = getCookie("emplogin")
      if (!isLoggedIn()) {
        LogIn("rpcUser", "rpcPass")
      }
      reloadPage();
    });

    if ("onhashchange" in window) { // event supported?
      window.onhashchange = function () {
        reloadPage();
      } 
    } else { // event not supported:
      var storedHash = window.location.hash;
      window.setInterval(function () {
        if (window.location.hash != storedHash) {
          storedHash = window.location.hash;
          reloadPage();
        }
      }, 100);
    }
    </script>
  </body>
</html>
